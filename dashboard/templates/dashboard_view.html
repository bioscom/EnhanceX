{% extends "base.html" %}

{% load i18n %}

{% load static %}
{% load table_tags %}

{% load widget_tweaks %}
{% load crispy_forms_tags %}

{% block title %} Dashboards {% endblock %}

{% block body %}

<style>
    th {
      white-space: nowrap;
    }
  
    td {
      white-space: nowrap;
    }
</style>

    <form action="{% url 'dashboard:edit_dashboard' oDashboard.id %}" method="POST">
        {% csrf_token %}
        <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addModalLabel">Update Dashboard</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        {% include 'partial_edit_dashboard.html' %}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <div class="card mb-2">
        <div class="card-header">
            <div class="row col-sm-12">
                <div class="col-sm-8">
                    <table>
                        <tr>
                            <td>
                                <img src="/media/logo/Dashboard.png" alt="" loading="lazy"/>
                            </td>
                            <td>
                                Dashboard
                                <div class="col-sm row">
                                    <div class="col-sm"><h5>{{oDashboard.name}}</h5></div>
                                    <div class="col-sm"><a type="button" data-bs-toggle="modal" data-bs-target="#editModal"><i class="fa fa-pencil fa-fw"></i></a></div>
                                </div>
                            </td>
                        </tr>
                    </table>
                    As of {% now "Y-m-d G:i:s" %} Viewing as {{oDashboard.created_by.get_full_name}}
                </div>

                <div class="col-sm-4">
                    <div class="btn-group pull-right" role="group" aria-label="Basic example">
                        <button type="button" class="btn btn-light border border-2 border-secondary">Refresh</button>
                        <button type="button" class="btn btn-light border border-2 border-secondary">Edit</button>
                        <button class="btn btn-secondary border border-2 border-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false"></button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#deleteModal">Download</a></li>
                            <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#ownerModal">Save As</a></li>
                            <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#ownerModal">New Dashboard</a></li>
                            <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#ownerModal">Change Owner</a></li>
                            <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#ownerModal">Delete</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

   
    <div class="col-sm-12">
        {{table|safe}}
        <div class="row col-sm-12 mb-2">
            <div class="col-sm-6">
                <div class="card shadow">
                    <div id="chart-container">{{ doughnut_chart|safe }}</div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="card shadow">
                    <div id="chart-container">{{ doughnut_chart2|safe }}</div>
                </div>
            </div>
        </div>
        
        <div class="row col-sm-12 mb-2">
            <div class="col-sm-6">
                <div class="card">
                    <div id="chart-container">{{ function_chart|safe }}</div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="card shadow">
                    <div id="chart-container">{{ bar_chart|safe }}</div>
                </div>
            </div>
        </div>

        <div class="row col-sm-12 mb-2">
            <div class="col-sm-6">
                <div class="card">
                    <div id="chart-container">{{ Lgate_chart|safe }}</div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="card">
                    <div id="chart-container">{{ hbar_chart|safe }}</div>
                </div>
            </div>
        </div>

        <div class="row col-sm-12 mb-2">
            <div class="col-sm-6">
                <div class="card">
                    <div id="chart-container">{{ LGate_Count|safe }}</div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card">
                    {% if graph_json %}
                        <div id="chart"></div>
                        <script>
                            var graph = {{ graph_json | safe }};
                            Plotly.newPlot('chart', graph.data, graph.layout);
                        </script>
                    {% else %}
                        <p>No initiatives created in the last 7 days.</p>
                    {% endif %}

                </div>
            </div>
        </div>
    </div>

    
    <br><br><br>


{% endblock %}


